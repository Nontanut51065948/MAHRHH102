<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Portal - Login & Register</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600&display=swap" rel="stylesheet">
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            font-family: 'Kanit', sans-serif;
            background-color: #111111; /* โทนสีดำ */
        }
        .text-theme-yellow { color: #FBBF24; }
        .bg-theme-yellow { background-color: #FBBF24; }
        .hover-bg-theme-yellow:hover { background-color: #F59E0B; }
        
        /* Custom Checkbox for Captcha */
        .captcha-box {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: #f9f9f9;
            border: 1px solid #ddd;
            padding: 12px 16px;
            border-radius: 4px;
            cursor: pointer;
        }
        .captcha-checkbox {
            width: 24px;
            height: 24px;
            border: 2px solid #ccc;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            transition: all 0.2s;
        }
        .captcha-checkbox.checked {
            border-color: #22c55e;
        }
        .captcha-checkbox.checked::after {
            content: '\f00c';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            color: #22c55e;
            font-size: 14px;
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <!-- Main Container -->
    <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden relative">
        
        <!-- Header Design -->
        <div class="bg-black p-6 text-center border-b-4 border-yellow-400">
            <h1 class="text-3xl font-bold text-white tracking-wide">
                <span class="text-theme-yellow">EMP</span>PORTAL
            </h1>
            <p class="text-gray-400 text-sm mt-1">ระบบจัดการพนักงาน</p>
        </div>

        <div class="p-8">
            <!-- ================= REGISTER FORM ================= -->
            <div id="register-view">
                <h2 class="text-2xl font-semibold mb-6 text-center text-gray-800">สร้างบัญชีผู้ใช้ใหม่</h2>
                
                <form id="registerForm" onsubmit="handleRegister(event)">
                    <!-- Username -->
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-1">เบอร์โทรศัพท์ หรือ Email</label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="fa-solid fa-user text-gray-400"></i>
                            </div>
                            <input type="text" id="reg-username" required placeholder="name@example.com หรือ 0891234567" 
                                class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-yellow-400 outline-none transition">
                        </div>
                    </div>

                    <!-- Password -->
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-1">รหัสผ่าน</label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="fa-solid fa-lock text-gray-400"></i>
                            </div>
                            <input type="password" id="reg-password" required placeholder="กำหนดรหัสผ่าน" 
                                class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-yellow-400 outline-none transition">
                        </div>
                    </div>

                    <!-- Confirm Password -->
                    <div class="mb-2">
                        <label class="block text-sm font-medium text-gray-700 mb-1">ยืนยันรหัสผ่านอีกครั้ง</label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="fa-solid fa-check-double text-gray-400"></i>
                            </div>
                            <input type="password" id="reg-confirm-password" required placeholder="กรอกรหัสผ่านอีกครั้ง" 
                                class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-yellow-400 outline-none transition">
                        </div>
                        <p class="text-xs text-gray-500 mt-1"><i class="fa-solid fa-circle-info mr-1"></i>แนะนำ: เพิ่มสัญลักษณ์ต่อท้ายเพื่อความปลอดภัย (เช่น */@#$%%^&)</p>
                    </div>

                    <!-- Mock Captcha -->
                    <div class="mb-6 mt-4">
                        <div class="captcha-box" onclick="toggleCaptcha()">
                            <div class="flex items-center gap-3">
                                <div id="captcha-check" class="captcha-checkbox"></div>
                                <span class="text-sm font-medium text-gray-700">ฉันไม่ใช่โปรแกรมอัตโนมัติ</span>
                            </div>
                            <div class="flex flex-col items-center">
                                <i class="fa-solid fa-recycle text-blue-500 text-xl"></i>
                                <span class="text-[10px] text-gray-400 mt-1">reCAPTCHA</span>
                            </div>
                        </div>
                        <p id="captcha-error" class="text-red-500 text-xs mt-1 hidden">กรุณายืนยันว่าคุณไม่ใช่หุ่นยนต์</p>
                    </div>

                    <!-- Submit Button -->
                    <button type="submit" class="w-full bg-theme-yellow hover-bg-theme-yellow text-black font-semibold py-3 rounded-lg shadow-md transition duration-200 transform hover:scale-[1.02]">
                        ยืนยันการสมัคร
                    </button>
                </form>

                <div class="mt-6 text-center">
                    <p class="text-sm text-gray-600">มีบัญชีผู้ใช้แล้ว? 
                        <button onclick="switchView('login')" class="text-black font-semibold hover:text-yellow-600 underline decoration-yellow-400 decoration-2 underline-offset-4">เข้าสู่ระบบที่นี่</button>
                    </p>
                </div>
            </div>

            <!-- ================= LOGIN FORM ================= -->
            <div id="login-view" class="hidden">
                <h2 class="text-2xl font-semibold mb-6 text-center text-gray-800">เข้าสู่ระบบ</h2>
                
                <form id="loginForm" onsubmit="handleLogin(event)">
                    <!-- Username -->
                    <div class="mb-5">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Username / E-mail / เบอร์โทร</label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="fa-solid fa-user text-gray-400"></i>
                            </div>
                            <input type="text" id="login-username" required placeholder="กรอกชื่อผู้ใช้งาน" 
                                class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-yellow-400 outline-none transition bg-gray-50">
                        </div>
                    </div>

                    <!-- Password -->
                    <div class="mb-6">
                        <label class="block text-sm font-medium text-gray-700 mb-1">Password</label>
                        <div class="relative">
                            <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                <i class="fa-solid fa-lock text-gray-400"></i>
                            </div>
                            <input type="password" id="login-password" required placeholder="กรอกรหัสผ่าน" 
                                class="w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-yellow-400 outline-none transition bg-gray-50">
                        </div>
                    </div>

                    <!-- Submit Button -->
                    <button type="submit" class="w-full bg-black hover:bg-gray-800 text-white font-semibold py-3 rounded-lg shadow-md transition duration-200 transform hover:scale-[1.02] border-2 border-black hover:border-yellow-400">
                        เข้าสู่ระบบ
                    </button>
                </form>

                <div class="mt-6 text-center">
                    <p class="text-sm text-gray-600">ยังไม่มีบัญชี? 
                        <button onclick="switchView('register')" class="text-black font-semibold hover:text-yellow-600 underline decoration-yellow-400 decoration-2 underline-offset-4">สมัครสมาชิกใหม่</button>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- ================= MODAL (MESSAGE BOX) ================= -->
    <div id="customModal" class="fixed inset-0 bg-black bg-opacity-60 hidden flex items-center justify-center z-50 p-4 opacity-0 transition-opacity duration-300">
        <div class="bg-white rounded-xl shadow-2xl max-w-sm w-full p-6 text-center transform scale-95 transition-transform duration-300" id="modalContent">
            <div id="modalIcon" class="w-16 h-16 mx-auto rounded-full flex items-center justify-center mb-4">
                <!-- Icon injected by JS -->
            </div>
            <h3 id="modalTitle" class="text-xl font-bold text-gray-900 mb-2">แจ้งเตือน</h3>
            <p id="modalMessage" class="text-gray-600 text-sm mb-6 leading-relaxed"></p>
            <p id="modalEmailNote" class="text-blue-600 text-xs mb-6 font-medium hidden bg-blue-50 p-2 rounded"></p>
            <button onclick="closeModal()" class="w-full bg-theme-yellow hover-bg-theme-yellow text-black font-semibold py-2 rounded-lg transition">
                ตกลง
            </button>
        </div>
    </div>

    <!-- JavaScript Logic -->
    <script>
        let isCaptchaChecked = false;

        // Toggle Captcha Checkbox
        function toggleCaptcha() {
            const checkEl = document.getElementById('captcha-check');
            isCaptchaChecked = !isCaptchaChecked;
            if (isCaptchaChecked) {
                checkEl.classList.add('checked');
                document.getElementById('captcha-error').classList.add('hidden');
            } else {
                checkEl.classList.remove('checked');
            }
        }

        // Switch between Register and Login views
        function switchView(view) {
            const regView = document.getElementById('register-view');
            const loginView = document.getElementById('login-view');
            
            if (view === 'login') {
                regView.classList.add('hidden');
                loginView.classList.remove('hidden');
                // Clear register form
                document.getElementById('registerForm').reset();
                isCaptchaChecked = false;
                document.getElementById('captcha-check').classList.remove('checked');
            } else {
                loginView.classList.add('hidden');
                regView.classList.remove('hidden');
                // Clear login form
                document.getElementById('loginForm').reset();
            }
        }

        // Handle Register Submit
        function handleRegister(e) {
            e.preventDefault();
            
            const username = document.getElementById('reg-username').value;
            const password = document.getElementById('reg-password').value;
            const confirmPassword = document.getElementById('reg-confirm-password').value;

            // Validate Passwords match
            if (password !== confirmPassword) {
                showModal('ข้อผิดพลาด', 'รหัสผ่านและยืนยันรหัสผ่านไม่ตรงกัน กรุณาตรวจสอบอีกครั้ง', 'error');
                return;
            }

            // Validate Captcha
            if (!isCaptchaChecked) {
                document.getElementById('captcha-error').classList.remove('hidden');
                return;
            }

            // Check if input looks like an email to show email verification message
            const isEmail = username.includes('@');
            let emailNote = '';
            if (isEmail) {
                emailNote = `<i class="fa-solid fa-envelope-circle-check mr-1"></i> ระบบได้ส่งลิงก์ยืนยันตัวตนไปยังอีเมล <b>${username}</b> ของท่านแล้ว กรุณากดยืนยันเพื่อสิทธิการใช้งานที่สมบูรณ์`;
            }

            // Show Success Message
            showModal(
                'สร้างบัญชีสำเร็จ!', 
                `<b>(ท่านสามารถเข้าสู่ระบบโดยใช้ Username / Password นี้ได้แล้ว)</b>`, 
                'success',
                emailNote
            );

            // Pre-fill login username
            document.getElementById('login-username').value = username;

            // Switch to login view in background
            switchView('login');
        }

        // Handle Login Submit
        function handleLogin(e) {
            e.preventDefault();
            // Simulate Authentication delay
            const btn = e.target.querySelector('button[type="submit"]');
            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> กำลังตรวจสอบ...';
            btn.disabled = true;

            setTimeout(() => {
                btn.innerHTML = originalText;
                btn.disabled = false;
                
                // Show success and redirect
                showModal('เข้าสู่ระบบสำเร็จ', 'กำลังพาท่านเข้าสู่หน้าแดชบอร์ด...', 'success');
                
                // Redirect simulation
                setTimeout(() => {
                    closeModal();
                    // เปลี่ยนเป็น URL ที่ต้องการ เช่น window.location.href = 'https://example.com/dashboard';
                    document.body.innerHTML = `
                        <div class="min-h-screen bg-black flex flex-col items-center justify-center text-white p-4 text-center">
                            <h1 class="text-4xl text-yellow-400 font-bold mb-4">ยินดีต้อนรับเข้าสู่ระบบ</h1>
                            <p class="text-xl">Redirected to Dashboard URL successfully.</p>
                            <button onclick="location.reload()" class="mt-8 px-6 py-2 bg-yellow-400 text-black font-bold rounded hover:bg-yellow-500">กลับไปหน้า Login</button>
                        </div>
                    `;
                }, 1500);
            }, 1000);
        }

        // Modal Functions
        function showModal(title, message, type, emailNote = '') {
            const modal = document.getElementById('customModal');
            const iconContainer = document.getElementById('modalIcon');
            const titleEl = document.getElementById('modalTitle');
            const messageEl = document.getElementById('modalMessage');
            const emailNoteEl = document.getElementById('modalEmailNote');

            titleEl.innerHTML = title;
            messageEl.innerHTML = message;

            if (emailNote) {
                emailNoteEl.innerHTML = emailNote;
                emailNoteEl.classList.remove('hidden');
            } else {
                emailNoteEl.classList.add('hidden');
            }

            if (type === 'success') {
                iconContainer.className = 'w-16 h-16 mx-auto rounded-full flex items-center justify-center mb-4 bg-green-100 text-green-500 text-3xl';
                iconContainer.innerHTML = '<i class="fa-solid fa-check"></i>';
            } else {
                iconContainer.className = 'w-16 h-16 mx-auto rounded-full flex items-center justify-center mb-4 bg-red-100 text-red-500 text-3xl';
                iconContainer.innerHTML = '<i class="fa-solid fa-xmark"></i>';
            }

            modal.classList.remove('hidden');
            // Small delay for transition
            setTimeout(() => {
                modal.classList.remove('opacity-0');
                modal.querySelector('#modalContent').classList.remove('scale-95');
                modal.querySelector('#modalContent').classList.add('scale-100');
            }, 10);
        }

        function closeModal() {
            const modal = document.getElementById('customModal');
            modal.classList.add('opacity-0');
            modal.querySelector('#modalContent').classList.remove('scale-100');
            modal.querySelector('#modalContent').classList.add('scale-95');
            
            setTimeout(() => {
                modal.classList.add('hidden');
            }, 300); // Wait for transition
        }
    </script>
</body>
</html>